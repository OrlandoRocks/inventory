<section class="content">

  <div class="row">
    <div class="col-md-3">
      <!-- Profile Image -->
      <div class="box box-primary">
        <div class="box-body box-profile">

          <%= link_to edit_item_path(@item.id), :class => "btn btn-block btn-success btn-lg" do %>
              <i class="fa fa-pencil-square-o" > Editar Artículo</i>
          <% end %>

          <%= image_tag @item.image.present?? (@item.image.url.include? "pdf" )?  'pdf_download.png' : @item.image_url(:thumb).to_s : 'logoAgroTrailers.png', class: "profile-user-img img-responsive img-circle" %>

          <h3 class="profile-username text-center"><%= @item.name %></h3>

          <!--<div class="tab-content" ng-controller="manageItemController" ng-init="init(<%#= @item.to_json %>)">-->
            <!--<%#= t('.maintenance_done') %>-->
            <!--<%# if @item.maintenance_date and @item.time_quantity_service and @item.time_quantity_service > 0 %>-->
              <!--<input type="checkbox" class="js-switch" ui-switch="{size: 'small'}" ng-model="maintenanceDone" />-->
              <!--<div><%#= t('items.next_maintenances.maintenance_date_in_words') %></div>-->
              <!--<div class="text-center label label-<%#= Date.today > @item.maintenance_date ? 'danger' : 'success' %>">-->
                <!--<%#= distance_of_time_custom(Date.today, @item.maintenance_date) %>-->
              <!--</div>-->
            <!--<%# else %>-->
                <!--<div class="text-center label label-default">-->
                  <!--<%= next_maintenance(@item) %>-->
                <!--</div>-->
            <!--<%# end %>-->
          <!--</div>-->

          <p class="text-muted text-center"><%= @item.description %></p>

          <ul class="list-group list-group-unbordered">
            <li class="list-group-item">
              <b><%= t("items.form.model") %></b> <a class="pull-right"><%= @item.model %></a>
            </li>
            <li class="list-group-item">
              <b><%= t("items.form.serial_number") %></b> <a class="pull-right"><%= @item.serial_number %></a>
            </li>
            <li class="list-group-item">
              <b><%= t("items.form.purchased_date") %></b> <a class="pull-right"><%= @item.purchased_date %></a>
            </li>
            <li class="list-group-item">
              <b><%= t("items.form.price") %></b> <a class="pull-right"><%= "$ #{ "%.2f" % @item.price if @item.price.present?}"  %></a>
            </li>
            <li class="list-group-item">
              <strong><i class="fa fa-book margin-r-5"></i><%= "#{t("items.form.category")} / #{ t("items.form.sub_category")}" %></strong>
              <p class="text-muted">
                <%= "#{@item.sub_category.category.try("name") if @item.sub_category.present?} / #{ @item.sub_category.try("name")}"%>
              </p>
            </li>
            <!--<li class="list-group-item">-->
              <!--<b><%#= t("items.form.provider") %></b> <a class="pull-right"><%#= @item.provider.try("name") %></a>-->
            <!--</li>-->
            <li class="list-group-item">
              <strong><i class="fa fa-home margin-r-5"></i><%= "#{t("items.form.branch")}" %></strong>
              <p class="text-muted">
                <%= "#{@item.try(:branch).try(:name)}"%>
              </p>
            </li>
            <li class="list-group-item">
              <strong><i class="fa fa-home margin-r-5"></i><%= "#{t("items.form.department")}" %></strong>
              <p class="text-muted">
                <%= "#{@item.try(:department).try(:name)}"%>
              </p>
            </li>
            <li class="list-group-item">
              <strong><i class="fa fa-user margin-r-5"></i><%= "#{t("items.form.user")}" %></strong>
              <p class="text-muted">
                <%= "#{@item.user.try("full_name")}"%>
              </p>
            </li>

            <li class="list-group-item">
              <b><%= t("items.form.brand") %></b> <a class="pull-right"><%= @item.brand.try("name") %></a>
            </li>
            <li class="list-group-item">
              <b><%= t("items.form.status_item") %></b> <a class="pull-right"><%= @item.status_item.try("description") %></a>
            </li>

           <!-- <li class="list-group-item">
              <strong><i class="fa fa-book margin-r-5"></i> Education</strong>
              <p class="text-muted">
                B.S. in Computer Science from the University of Tennessee at Knoxville
              </p>
            </li>-->

            <!--<li class="list-group-item">-->
              <!--<strong><i class="fa fa-map-marker margin-r-5"></i> Location</strong>-->

              <!--<p class="text-muted">Malibu, California</p>-->

            <!--</li>-->

          </ul>

        </div>
        <!-- /.box-body -->
      </div>
      <!-- /.box -->
    </div>
    <!-- /.col -->
    <div class="col-md-9">
      <div class="nav-tabs-custom">
        <ul class="nav nav-tabs">
          <!--<li class="active"><a href="#activity" data-toggle="tab">Archivos del artículo:</a></li>-->
          <li><a href="#timeline" data-toggle="tab">Timeline del artículo</a></li>
        </ul>
        <div class="tab-content" ng-controller="itemController" ng-init="item=<%= @item.new_record? ? 0 : @item.id %>">

          <%#= render "item_file.html.erb" %>

          <div class="active tab-pane" id="timeline" >
            <ul class="timeline timeline-inverse">
              <!-- timeline time label -->
              <% @audits.reverse_each do |audit| %>
                  <% if audit.action == "create" and audit.associated_id.nil?%>
                      <li class="time-label">
                          <span class="bg-red">
                            <%= audit.created_at.strftime("%d / %m / %Y") %>
                          </span>
                      </li>
                      <!-- /.timeline-label -->
                      <!-- timeline item -->
                      <li>
                        <i class="fa fa-plus bg-green"></i>

                        <div class="timeline-item">
                          <span class="time"><i class="fa fa-clock-o"></i> <%= audit.created_at.strftime("%H:%M") %></span>

                          <h3 class="timeline-header"><strong><%=t(".audit.create")  %> <%= t(".audit.by") %>  <%= "#{User.find(audit.user_id).try(:employee_number)} - #{User.find(audit.user_id).try(:full_name)}"  if audit.user_id.present? %> </strong></h3>

                          <div class="timeline-body">
                            <%= t(".audit.create_mesage") %>
                          </div>
                          <!--<div class="timeline-footer">-->
                          <!--<a class="btn btn-primary btn-xs">Read more</a>-->
                          <!--<a class="btn btn-danger btn-xs">Delete</a>-->
                          <!--</div>-->
                        </div>
                      </li>
                  <% elsif audit.action == "create" and audit.associated_id%>
                          <li class="time-label">
                          <span class="bg-red">
                            <%= audit.created_at.strftime("%d / %m / %Y") %>
                          </span>
                          </li>
                          <!-- /.timeline-label -->
                          <!-- timeline item -->
                          <li>
                            <i class="fa fa-plus bg-green"></i>

                            <div class="timeline-item">
                              <span class="time"><i class="fa fa-clock-o"></i> <%= audit.created_at.strftime("%H:%M") %></span>

                              <h3 class="timeline-header"><strong><%=t(".audit.create")  %> <%= t(".audit.by") %>  <%= "#{User.find(audit.user_id).try(:employee_number)} - #{User.find(audit.user_id).try(:full_name)}"  if audit.user_id.present? %> </strong></h3>

                              <div class="timeline-body">
                                <%= audit.auditable_type == "ItemFile" ? t(".audit.file_mesage"): t(".audit.maintenance_mesage")  %>:
                                <br>
                                <%= audit.auditable_type == "ItemFile" ? t(".file_type.#{audit.audited_changes["file_type"]}"): audit.audited_changes["description"]  %>
                              </div>
                              <!--<div class="timeline-footer">-->
                              <!--<a class="btn btn-primary btn-xs">Read more</a>-->
                              <!--<a class="btn btn-danger btn-xs">Delete</a>-->
                              <!--</div>-->
                            </div>
                          </li>
                  <% elsif audit.action == "delete" and audit.associated_id%>
                      <li class="time-label">
                          <span class="bg-red">
                            <%= audit.created_at.strftime("%d / %m / %Y") %>
                          </span>
                      </li>
                      <!-- /.timeline-label -->
                      <!-- timeline item -->
                      <li>
                        <i class="fa fa-plus bg-green"></i>

                        <div class="timeline-item">
                          <span class="time"><i class="fa fa-clock-o"></i> <%= audit.created_at.strftime("%H:%M") %></span>

                          <h3 class="timeline-header"><strong><%=t(".audit.create")  %> <%= t(".audit.by") %>  <%= "#{User.find(audit.user_id).try(:employee_number)} - #{User.find(audit.user_id).try(:full_name)}"  if audit.user_id.present? %> </strong></h3>

                          <div class="timeline-body">
                            <%= audit.auditable_type == "ItemFile" ? t(".audit.file_mesage"): t(".audit.maintenance_mesage")  %>:
                            <br>
                            <%= audit.auditable_type == "ItemFile" ? t(".file_type.#{audit.audited_changes["file_type"]}"): audit.audited_changes["description"]  %>
                          </div>
                          <!--<div class="timeline-footer">-->
                          <!--<a class="btn btn-primary btn-xs">Read more</a>-->
                          <!--<a class="btn btn-danger btn-xs">Delete</a>-->
                          <!--</div>-->
                        </div>
                      </li>
                  <% else %>
                      <li class="time-label">
                          <span class="bg-red">
                            <%= audit.created_at.strftime("%d / %m / %Y") %>
                          </span>
                      </li>
                      <!-- /.timeline-label -->
                      <!-- timeline item -->
                      <li>
                        <i class="fa fa-refresh bg-blue"></i>

                        <div class="timeline-item">
                          <span class="time"><i class="fa fa-clock-o"></i> <%= audit.created_at.strftime("%H:%M") %></span>

                          <!-- TODO: Verificar porque el audit no tiene user_id -->
                          <h3 class="timeline-header">
                            <strong>
                              <%=t(".audit.#{audit.action}")  %> <%= t(".audit.by") %>  <%= "#{User.find(audit.user_id).try(:employee_number)} - #{User.find(audit.user_id).try(:full_name)}"  if audit.user_id.present? %>
                            </strong>
                          </h3>


                          <div class="timeline-body">
                            <% audit.audited_changes.keys.each do |key| %>

                                <% unless key.eql?('user_id') %>
                                    <%= "#{t('.audit.change')}: " %><strong><%= t(".audit.#{key}") %></strong>
                                <%end%>

                                <% case key %>
                                  <% when "time_unit_service"  %>
                                    <%= " #{t('.audit.from')} " %> <strong><%= audit.audited_changes[key][0].nil? ? "#{t('.audit.nil')}" : t(".time_units.#{audit.audited_changes[key][0].to_s}") %></strong>
                                    <%= " #{t('.audit.to')} " %> <strong><%= audit.audited_changes[key][1].nil? ? "#{t('.audit.nil')}" : t(".time_units.#{audit.audited_changes[key][1].to_s}") %></strong>

                                  <% when "provider_id"  %>
                                    <%= " #{t('.audit.from')} " %> <strong><%= audit.audited_changes[key][0].nil? ? "#{t('.audit.nil')}" : Provider.find_by(id: audit.audited_changes[key][0].to_s).try('name') %></strong>
                                    <%= " #{t('.audit.to')} " %> <strong><%= audit.audited_changes[key][1].nil? ? "#{t('.audit.nil')}" : Provider.find_by(id: audit.audited_changes[key][1].to_s).try('name') %></strong>

                                  <% when "department_id"  %>
                                    <%= " #{t('.audit.from')} " %> <strong><%= audit.audited_changes[key][0].nil? ? "#{t('.audit.nil')}" : Department.find_by(id: audit.audited_changes[key][0].to_s).try('name') %></strong>
                                    <%= " #{t('.audit.to')} " %> <strong><%= audit.audited_changes[key][1].nil? ? "#{t('.audit.nil')}" : Department.find_by(id: audit.audited_changes[key][1].to_s).try('name')%></strong>

                                <% when "sub_category_id"  %>
                                    <%= " #{t('.audit.from')} " %> <strong><%= audit.audited_changes[key][0].nil? ? "#{t('.audit.nil')}" : SubCategory.find_by(id: audit.audited_changes[key][0].to_s).try('name') %></strong>
                                    <%= " #{t('.audit.to')} " %> <strong><%= audit.audited_changes[key][1].nil? ? "#{t('.audit.nil')}" : SubCategory.find_by(id: audit.audited_changes[key][1].to_s).try('name')%></strong>

                                    <%# when "user_id"  %>
                                    <%#= " #{t('.audit.from')} " %> <strong><%#= audit.audited_changes[key][0].nil? ? "#{t('.audit.nil')}" : User.find_by(id: audit.audited_changes[key][0].to_s).try('full_name') %></strong>
                                    <%#= " #{t('.audit.to')} " %> <strong><%#= audit.audited_changes[key][1].nil? ? "#{t('.audit.nil')}" : User.find_by(id: audit.audited_changes[key][1].to_s).try('full_name') %></strong>

                                  <% when "brand_id"  %>
                                    <%= " #{t('.audit.from')} " %> <strong><%= audit.audited_changes[key][0].nil? ? "#{t('.audit.nil')}" : Brand.find_by(id: audit.audited_changes[key][0].to_s).try('name') %></strong>
                                    <%= " #{t('.audit.to')} " %> <strong><%= audit.audited_changes[key][1].nil? ? "#{t('.audit.nil')}" : Brand.find_by(id: audit.audited_changes[key][1].to_s).try('name') %></strong>

                                  <% when "status_item_id"  %>
                                    <%= " #{t('.audit.from')} " %> <strong><%= audit.audited_changes[key][0].nil? ? "#{t('.audit.nil')}" : StatusItem.find_by(id: audit.audited_changes[key][0].to_s).try('name') %></strong>
                                    <%= " #{t('.audit.to')} " %> <strong><%= audit.audited_changes[key][1].nil? ? "#{t('.audit.nil')}" : StatusItem.find_by(id: audit.audited_changes[key][1].to_s).try('name') %></strong>

                                  <% else %>
                                    <% unless key.eql?('user_id') %>
                                        <%= " #{t('.audit.from')} " %>  <strong><%= audit.audited_changes[key][0].nil? ? "#{t('.audit.nil')}" : audit.audited_changes[key][0] %></strong>
                                        <%= " #{t('.audit.to')} " %>  <strong><%= audit.audited_changes[key][1].nil? ? "#{t('.audit.nil')}" : audit.audited_changes[key][1] %></strong>
                                    <%end%>
                                  <% end %>


                                <br>
                            <% end %>
                          </div>
                          <!--<div class="timeline-footer">-->
                          <!--<a class="btn btn-primary btn-xs">Read more</a>-->
                          <!--<a class="btn btn-danger btn-xs">Delete</a>-->
                          <!--</div>-->
                        </div>
                      </li>
                  <% end %>

              <% end %>
              <!-- END timeline item -->
              <!-- timeline item -->
              <!--<li>-->
                <!--<i class="fa fa-user bg-aqua"></i>-->

                <!--<div class="timeline-item">-->
                  <!--<span class="time"><i class="fa fa-clock-o"></i> 5 mins ago</span>-->

                  <!--<h3 class="timeline-header no-border"><a href="#">Sarah Young</a> accepted your friend request-->
                  <!--</h3>-->
                <!--</div>-->
              <!--</li>-->
              <!--&lt;!&ndash; END timeline item &ndash;&gt;-->
              <!--&lt;!&ndash; timeline item &ndash;&gt;-->
              <!--<li>-->
                <!--<i class="fa fa-comments bg-yellow"></i>-->

                <!--<div class="timeline-item">-->
                  <!--<span class="time"><i class="fa fa-clock-o"></i> 27 mins ago</span>-->

                  <!--<h3 class="timeline-header"><a href="#">Jay White</a> commented on your post</h3>-->

                  <!--<div class="timeline-body">-->
                    <!--Take me to your leader!-->
                    <!--Switzerland is small and neutral!-->
                    <!--We are more like Germany, ambitious and misunderstood!-->
                  <!--</div>-->
                  <!--<div class="timeline-footer">-->
                    <!--<a class="btn btn-warning btn-flat btn-xs">View comment</a>-->
                  <!--</div>-->
                <!--</div>-->
              <!--</li>-->
              <!--&lt;!&ndash; END timeline item &ndash;&gt;-->
              <!--&lt;!&ndash; timeline time label &ndash;&gt;-->
              <!--<li class="time-label">-->
                        <!--<span class="bg-green">-->
                          <!--3 Jan. 2014-->
                        <!--</span>-->
              <!--</li>-->
              <!--&lt;!&ndash; /.timeline-label &ndash;&gt;-->
              <!--&lt;!&ndash; timeline item &ndash;&gt;-->
              <!--<li>-->
                <!--<i class="fa fa-camera bg-purple"></i>-->

                <!--<div class="timeline-item">-->
                  <!--<span class="time"><i class="fa fa-clock-o"></i> 2 days ago</span>-->

                  <!--<h3 class="timeline-header"><a href="#">Mina Lee</a> uploaded new photos</h3>-->

                  <!--<div class="timeline-body">-->
                    <!--<img src="http://placehold.it/150x100" alt="..." class="margin">-->
                    <!--<img src="http://placehold.it/150x100" alt="..." class="margin">-->
                    <!--<img src="http://placehold.it/150x100" alt="..." class="margin">-->
                    <!--<img src="http://placehold.it/150x100" alt="..." class="margin">-->
                  <!--</div>-->
                <!--</div>-->
              <!--</li>-->
              <!-- END timeline item -->
              <li>
                <i class="fa fa-clock-o bg-gray"></i>
              </li>
            </ul>


          </div>

        </div>
        <!-- /.tab-content -->
      </div>
      <!-- /.nav-tabs-custom -->
    </div>
    <!-- /.col -->
  </div>
  <!-- /.row -->



</section>
